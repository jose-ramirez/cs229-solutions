\documentclass{article}
\title{Problem set 1 - P2}
\usepackage{amssymb}
\usepackage{amsmath}
\author{Jose Ramirez}
\setlength{\parindent}{0pt}
\pdfpagewidth 8.5in
\pdfpageheight 11in

\begin{document}
\maketitle

\begin{enumerate}

\item
$$
	\frac{e^{-\lambda}\lambda^{y}}{y!} =
	\frac{e^{-\lambda + y\log\lambda}}{y!} =
	\left(\frac{1}{y!}\right) \exp(y\log\lambda -\lambda),
$$

hence:

\begin{align*}
	b(y) = \frac{1}{y!}, \\
	\eta = \log \lambda, \\
	a(\eta) = \lambda = e^{\eta}, \\
	T(y) = y.
\end{align*}

\item $g(\eta) = \lambda = e^{\eta}$.

\item
$$
	\log p(y^{(i)}|x^{(i)}; \theta) = \log(\frac{1}{y!}) + y^{(i)}\eta - e^{\eta},
$$

so:

\begin{align*}
	\frac{\partial}{\partial \theta_{j}}\log p(y^{(i)}|x^{(i)}; \theta) = \\
	\frac{\partial}{\partial \theta_{j}}\left(\log \left(\frac{1}{y!}\right) + y^{(i)}\eta - e^{\eta}\right) = \\
	\frac{\partial}{\partial \theta_{j}}\left(\log \left(\frac{1}{y!}\right) + y^{(i)}(\theta^Tx^{(i)}) - e^{\theta^Tx^{(i)}}\right) = \\
	y^{(i)}x^{(i)}_{j} - e^{\theta^Tx^{(i)}} \frac{\partial}{\partial \theta_{j}}(\theta^Tx^{(i)}) = \\
	x^{(i)}_{j}(y^{(i)} - e^{\theta^Tx^{(i)}}),
\end{align*}

and so our rule for gradient ascent is:

$$
	\theta_{j} := \theta_{j} - \alpha x^{(i)}_{j} (y^{(i)} - e^{\theta^Tx^{(i)}}).
$$
\end{enumerate}
\end{document}
